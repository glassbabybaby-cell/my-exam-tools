<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç”ŸåŒ–åˆ·é¡Œç¥å™¨ v5.0 PRO - çµ‚æ¥µç‰ˆ</title>
    <!-- Tailwind CSS: è² è²¬æ’ç‰ˆèˆ‡ç¾åŒ– -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome: è² è²¬å„ç¨®å‹•æ…‹å°åœ–ç¤º -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=JetBrains+Mono&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; -webkit-tap-highlight-color: transparent; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        /* åŸºç¤å‹•ç•« */
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .shake { animation: shake 0.4s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        .btn-active:active { transform: scale(0.96); transition: 0.1s; }

        /* æ‰‹å¯«é¡Œå°ˆç”¨ï¼šè¼¸å…¥æ¡†åº•ç·šæ•ˆæœ */
        .typing-input {
            border: none;
            border-bottom: 3px solid #e2e8f0;
            background: transparent;
            transition: all 0.3s;
        }
        .typing-input:focus {
            outline: none;
            border-bottom-color: #6366f1;
            background: #f8fafc;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 min-h-screen flex flex-col">

    <!-- ä¸»å®¹å™¨ -->
    <div id="app" class="max-w-md mx-auto w-full min-h-screen bg-white shadow-2xl flex flex-col relative overflow-hidden">
        
        <!-- Header: é ‚éƒ¨å°èˆª -->
        <header class="bg-slate-900 text-white p-4 flex justify-between items-center shadow-lg z-20">
            <div class="flex items-center gap-2 cursor-pointer" onclick="renderHome()">
                <div class="bg-gradient-to-tr from-cyan-400 to-blue-600 text-white w-8 h-8 rounded-lg flex items-center justify-center font-black shadow-lg">B</div>
                <h1 class="font-bold text-lg">ç”ŸåŒ–å¤§å¸« <span class="text-[10px] bg-cyan-500 text-black px-1 rounded ml-1">V5.0</span></h1>
            </div>
            <div class="flex gap-2">
                <button onclick="confirmReset()" class="text-slate-400 hover:text-white px-2"><i class="fas fa-redo-alt"></i></button>
                <button onclick="showLeaderboard()" class="text-xs bg-indigo-600 hover:bg-indigo-500 px-3 py-1.5 rounded-full shadow-lg flex items-center gap-1 transition">
                    <i class="fas fa-skull"></i> éŒ¯é¡Œæ’è¡Œæ¦œ
                </button>
            </div>
        </header>

        <!-- ä¸»è¦å…§å®¹å€ï¼šé€é JavaScript åˆ‡æ› HTML å…§å®¹ -->
        <main id="content-area" class="flex-grow flex flex-col relative overflow-y-auto bg-slate-50">
            <!-- é€™è£¡æ˜¯å‹•æ…‹ç”Ÿæˆçš„å…§å®¹ -->
        </main>

    </div>

    <script>
        // ==========================================
        // 1. ã€é¡Œåº«æ ¸å¿ƒã€‘ 
        // ==========================================
        // é¡åˆ¥èªªæ˜ï¼š
        // type: "multiple" -> é¸æ“‡é¡Œ (é¸é …éš¨æ©Ÿ)
        // type: "handwriting" -> æ‰‹å¯«é¡Œ (è‡ªæˆ‘è©•åˆ†æ¨¡å¼)
        const questionBank = [
            // --- é¸æ“‡é¡Œç¯„ä¾‹ ---
            { 
                id: "ch3_1", 
                chapter: "Ch3", 
                type: "multiple",
                q: "ä¸‹åˆ—ä½•è€…ç‚ºä¸­æ€§èƒºåŸºé…¸ï¼Ÿ", 
                options: ["ç”˜èƒºé…¸ (Glycine)", "é›¢èƒºé…¸ (Lysine)", "çµ„èƒºé…¸ (Histidine)", "éº©èƒºé…¸ (Glutamic acid)"], 
                rationale: "Glycine çš„å´éˆåªæœ‰ä¸€å€‹ Hï¼Œåˆ†ä¸å‡ºæ¥µæ€§ä¹Ÿç„¡é›»è·ï¼Œæ•…ç‚ºä¸­æ€§ã€‚" 
            },
            { 
                id: "ch3_45", 
                chapter: "Ch3", 
                type: "multiple",
                q: "é®åˆ€å‹è²§è¡€æ˜¯ç”±æ–¼è¡€ç´…ç´  Î² éˆç¬¬ 6 ä½çš„ Glutamate è¢«å–ä»£ç‚ºï¼Ÿ", 
                options: ["Valine (çºˆèƒºé…¸)", "Glycine", "Leucine", "Isoleucine"], 
                rationale: "è¨˜ä½å£è¨£ï¼šSickle = Valine (SV)ã€‚ç–æ°´æ€§å´éˆå°è‡´åˆ†å­èšåˆã€‚" 
            },
            
            // --- æ‰‹å¯«é¡Œç¯„ä¾‹ (é€™æ˜¯ä½ è¦çš„æ–°åŠŸèƒ½ï¼) ---
            {
                id: "hw_1",
                chapter: "åè©è§£é‡‹",
                type: "handwriting",
                q: "è«‹å¯«å‡ºã€è®Šæ€§ (Denaturation)ã€çš„å®šç¾©ï¼Œä¸¦èªªæ˜å®ƒæœƒç ´å£å“ªäº›çµæ§‹ï¼Ÿ",
                ans: "è®Šæ€§æ˜¯æŒ‡è›‹ç™½è³ªçš„é«˜ç´šçµæ§‹ï¼ˆäºŒã€ä¸‰ã€å››ç´šï¼‰å—åˆ°åŒ–å­¸æˆ–ç‰©ç†å› ç´ å½±éŸ¿è€Œæ‰“é–‹ï¼Œå°è‡´ç”Ÿç‰©æ´»æ€§å–ªå¤±ã€‚ä½†ã€ä¸€ç´šçµæ§‹ï¼ˆèƒœè‚½éµï¼‰ã€ä¸æœƒè¢«ç ´å£ã€‚",
                keywords: ["äºŒ", "ä¸‰", "å››", "ä¸€ç´š", "æ´»æ€§"], // ç³»çµ±æœƒè‡ªå‹•æª¢æŸ¥ä½ æœ‰æ²’æœ‰å¯«åˆ°é€™äº›å­—
                rationale: "è®Šæ€§ä¸ç­‰æ–¼æ°´è§£ï¼Œæ‰€ä»¥èƒœè‚½éµæ˜¯å®Œæ•´çš„ã€‚"
            },
            {
                id: "hw_2",
                chapter: "çµæ§‹åˆ†æ",
                type: "handwriting",
                q: "è§£é‡‹ç‚ºä»€éº¼ Proline è¢«ç¨±ç‚ºèºæ—‹ç ´å£è€… (Helix Breaker)ï¼Ÿ",
                ans: "å› ç‚º Proline å…·æœ‰ç’°ç‹€çµæ§‹ï¼Œé™åˆ¶äº†éª¨æ¶çš„æ—‹è½‰è§’åº¦ï¼Œä¸”å®ƒåœ¨èƒœè‚½éµä¸­ç¼ºä¹èˆ‡å…¶ä»–èƒºåŸºé…¸å½¢æˆæ°«éµæ‰€éœ€çš„é†¯èƒºæ°« (N-H)ã€‚",
                keywords: ["ç’°ç‹€", "æ°«éµ", "æ—‹è½‰"],
                rationale: "å®ƒæ˜¯äºèƒºåŸºé…¸ (Imino acid)ï¼Œçµæ§‹å¤©ç”Ÿå°±è·Ÿåˆ¥äººä¸ä¸€æ¨£ã€‚"
            },
            {
                id: "hw_3",
                chapter: "Ch7",
                type: "handwriting",
                q: "è«‹åˆ—å‡ºäººé«”çš„å…©ç¨®å¿…éœ€è„‚è‚ªé…¸ (ä¸­æ–‡æˆ–è‹±æ–‡)ã€‚",
                ans: "äºéº»æ²¹é…¸ (Linoleate) èˆ‡ æ¬¡äºéº»æ²¹é…¸ (Alpha-linolenate)ã€‚",
                keywords: ["äºéº»æ²¹é…¸", "æ¬¡äºéº»æ²¹é…¸"],
                rationale: "DHA å’Œ èŠ±ç”Ÿå››çƒ¯é…¸å¯ä»¥ç”±é€™å…©è€…åˆæˆï¼Œæ‰€ä»¥åš´æ ¼ä¾†èªªé€™å…©è€…æ‰æ˜¯æºé ­ã€‚"
            }
        ];

        // ==========================================
        // 2. ã€ç‹€æ…‹ç®¡ç†ã€‘ è² è²¬è¨˜æ†¶èˆ‡é€²åº¦
        // ==========================================
        const DB_KEY = 'biochem_v5_pro_data';
        let state = {
            doneIds: [],      // å·²ç¶“å¾¹åº•è§£æ±ºçš„é¡Œç›® (å¾ç‰Œå †ç§»é™¤)
            wrongStats: {},   // éŒ¯é¡Œè¨ˆæ•¸å™¨ï¼š { 'ch3_1': 5 }
            currentBatch: [], // ç›®å‰é€™è¼ª 10 é¡Œ
            batchIndex: 0,
            score: 0
        };

        function save() { localStorage.setItem(DB_KEY, JSON.stringify(state)); }
        function load() { 
            const data = localStorage.getItem(DB_KEY);
            if (data) state = JSON.parse(data);
        }

        // ==========================================
        // 3. ã€å·¥å…·å‡½æ•¸ã€‘ 
        // ==========================================
        
        // é¸é …éš¨æ©Ÿæ´—ç‰Œ
        function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }

        // ==========================================
        // 4. ã€æ ¸å¿ƒæ§åˆ¶ã€‘ 
        // ==========================================

        function startMode(mode) {
            let pool = [];
            
            if (mode === 'wrong_drill') {
                // å¾æ’è¡Œæ¦œé»é€²ä¾†çš„ã€ŒéŒ¯é¡Œæ®²æ»…ã€
                const wrongIds = Object.keys(state.wrongStats).filter(id => state.wrongStats[id] > 0);
                pool = questionBank.filter(q => wrongIds.includes(q.id));
                if (pool.length === 0) { alert("æ­å–œï¼ä½ ç›®å‰æ²’æœ‰éŒ¯é¡Œï¼"); return; }
            } else {
                // æ­£å¸¸çš„åˆ·é¡Œæ¨¡å¼ (æ’é™¤å·²åšéçš„)
                pool = questionBank.filter(q => !state.doneIds.includes(q.id));
                if (pool.length === 0) { renderAllDone(); return; }
            }

            const batch = shuffle([...pool]).slice(0, 10);
            
            state.currentBatch = batch.map(q => {
                if (q.type === 'multiple') {
                    const opts = q.options.map((t, i) => ({ text: t, isCorrect: i === 0 }));
                    return { ...q, randomOptions: shuffle(opts) };
                }
                return q; // æ‰‹å¯«é¡Œç›´æ¥å›å‚³
            });

            state.batchIndex = 0;
            state.score = 0;
            save();
            renderQuiz();
        }

        // å–®é¡Œç‰¹è¨“
        function drillOne(id) {
            const q = questionBank.find(x => x.id === id);
            if (!q) return;
            state.currentBatch = [q];
            if (q.type === 'multiple') {
                const opts = q.options.map((t, i) => ({ text: t, isCorrect: i === 0 }));
                state.currentBatch[0].randomOptions = shuffle(opts);
            }
            state.batchIndex = 0;
            renderQuiz();
        }

        // ==========================================
        // 5. ã€ç•«é¢æ¸²æŸ“ã€‘ 
        // ==========================================
        const view = document.getElementById('content-area');

        function init() {
            load();
            if (state.currentBatch.length > 0 && state.batchIndex < state.currentBatch.length) {
                renderQuiz();
            } else {
                renderHome();
            }
        }

        // --- é¦–é  ---
        function renderHome() {
            load();
            const total = questionBank.length;
            const done = state.doneIds.length;
            const remaining = total - done;

            view.innerHTML = `
                <div class="p-6 flex flex-col items-center justify-center min-h-full space-y-8 fade-in">
                    <div class="text-center">
                        <h2 class="text-3xl font-black text-slate-800 mb-2">æŒæ¡åº¦ç‰¹è¨“</h2>
                        <p class="text-slate-500">å‰©é¤˜æŒ‘æˆ°ï¼š<span class="font-bold text-indigo-600">${remaining}</span> / ${total}</p>
                    </div>

                    <div class="w-full bg-slate-200 rounded-full h-3 overflow-hidden">
                        <div class="bg-indigo-500 h-full transition-all duration-700" style="width: ${(done/total)*100}%"></div>
                    </div>

                    <div class="flex flex-col w-full gap-4">
                        <button onclick="startMode('normal')" class="bg-slate-900 text-white font-bold py-4 rounded-2xl shadow-xl btn-active text-lg flex items-center justify-center gap-3">
                            <i class="fas fa-bolt text-yellow-400"></i> é–‹å§‹æ··åˆç‰¹è¨“
                        </button>
                        <button onclick="startMode('wrong_drill')" class="bg-white border-2 border-red-100 text-red-600 font-bold py-4 rounded-2xl shadow-md btn-active text-lg flex items-center justify-center gap-3">
                            <i class="fas fa-skull"></i> éŒ¯é¡Œå°ˆé …è¤‡ç¿’
                        </button>
                    </div>

                    <div class="text-xs text-slate-400 text-center italic">
                        åŒ…å«é¸æ“‡é¡Œèˆ‡æ‰‹å¯«é¡Œï¼Œå¾¹åº•æ“Šç¢ç›²é»ã€‚
                    </div>
                </div>
            `;
        }

        // --- åˆ·é¡Œä¸­ç•«é¢ ---
        function renderQuiz() {
            const q = state.currentBatch[state.batchIndex];
            const num = state.batchIndex + 1;
            const total = state.currentBatch.length;

            let html = `
                <div class="p-5 flex flex-col h-full fade-in">
                    <div class="flex justify-between text-[10px] font-black text-slate-400 mb-4 tracking-widest">
                        <span>${q.chapter} | ${q.type === 'multiple' ? 'é¸æ“‡é¡Œ' : 'æ‰‹å¯«é¡Œ'}</span>
                        <span>${num} / ${total}</span>
                    </div>

                    <div class="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm mb-6">
                        <h2 class="text-xl font-bold text-slate-800 leading-relaxed">${q.q}</h2>
                    </div>
            `;

            if (q.type === 'multiple') {
                // é¸æ“‡é¡Œç‰ˆé¢
                html += `
                    <div class="space-y-3 flex-grow">
                        ${q.randomOptions.map((o, i) => `
                            <button onclick="pickChoice(${i})" class="opt-btn w-full text-left p-4 rounded-xl border-2 border-slate-100 hover:border-indigo-500 transition flex gap-3 btn-active bg-white">
                                <div class="w-6 h-6 rounded-full bg-slate-100 text-slate-400 text-[10px] flex items-center justify-center font-bold">${String.fromCharCode(65+i)}</div>
                                <span class="text-slate-700 font-medium">${o.text}</span>
                            </button>
                        `).join('')}
                    </div>
                `;
            } else {
                // æ‰‹å¯«é¡Œç‰ˆé¢
                html += `
                    <div class="flex-grow space-y-4">
                        <textarea id="handwritten-input" class="w-full h-32 p-4 rounded-xl border-2 border-slate-200 bg-white focus:border-indigo-500 focus:ring-0 transition text-slate-700 placeholder:text-slate-300" placeholder="è«‹åœ¨é€™è£¡è¼¸å…¥ä½ çš„å›ç­”..."></textarea>
                        <button id="show-ans-btn" onclick="revealHandwritingAnswer()" class="w-full bg-slate-800 text-white font-bold py-4 rounded-xl shadow-lg btn-active">
                            è¼¸å…¥å®Œæˆï¼ŒæŸ¥çœ‹ç­”æ¡ˆ
                        </button>
                    </div>
                `;
            }

            // åé¥‹å€ (éš±è—)
            html += `
                    <div id="feedback" class="hidden mt-6 bg-slate-900 text-white p-5 rounded-2xl fade-in">
                        <div id="result-status" class="font-black text-lg mb-2"></div>
                        <div id="correct-ans-area" class="hidden mb-4">
                            <h4 class="text-cyan-400 text-xs font-bold uppercase mb-1">æ­£ç¢ºç­”æ¡ˆï¼š</h4>
                            <p class="text-white text-sm bg-slate-800 p-3 rounded-lg border border-slate-700 mono leading-relaxed">${q.ans}</p>
                        </div>
                        <div id="rationale-area">
                            <h4 class="text-indigo-400 text-xs font-bold uppercase mb-1">è©³è§£åˆ†æï¼š</h4>
                            <p id="rationale-text" class="text-slate-300 text-sm leading-relaxed"></p>
                        </div>
                        
                        <!-- æ‰‹å¯«é¡Œå°ˆç”¨çš„è©•åˆ†æŒ‰éˆ• -->
                        <div id="self-grade-btns" class="hidden grid grid-cols-2 gap-3 mt-6">
                            <button onclick="recordHandwriting(false)" class="bg-red-500/20 text-red-400 border border-red-500/50 py-3 rounded-xl font-bold hover:bg-red-500 hover:text-white transition">æˆ‘ç­”éŒ¯äº†</button>
                            <button onclick="recordHandwriting(true)" class="bg-green-500 text-white py-3 rounded-xl font-bold shadow-lg shadow-green-500/30 hover:bg-green-600 transition">æˆ‘ç­”å°äº†</button>
                        </div>

                        <button id="next-btn" onclick="nextQuestion()" class="hidden mt-6 w-full bg-indigo-500 text-white font-bold py-4 rounded-xl hover:bg-indigo-600 transition">ä¸‹ä¸€é¡Œ â”</button>
                    </div>
                </div>
            `;

            view.innerHTML = html;
        }

        // --- è™•ç†é¸æ“‡é¡Œ ---
        function pickChoice(idx) {
            const q = state.currentBatch[state.batchIndex];
            const chosen = q.randomOptions[idx];
            const isCorrect = chosen.isCorrect;

            const btns = document.querySelectorAll('.opt-btn');
            btns.forEach(b => b.disabled = true);

            const feedback = document.getElementById('feedback');
            const status = document.getElementById('result-status');
            const ratText = document.getElementById('rationale-text');
            const nextBtn = document.getElementById('next-btn');

            if (isCorrect) {
                state.score++;
                btns[idx].classList.add('border-green-500', 'bg-green-50');
                status.innerHTML = `<span class="text-green-400"><i class="fas fa-check-circle"></i> æ­å–œç­”å°ï¼</span>`;
                if (state.wrongStats[q.id] > 0) state.wrongStats[q.id]--;
                // ç­”å°å°±å¾ã€Œæœªåšéç‰Œå †ã€ç§»é™¤
                if (!state.doneIds.includes(q.id)) state.doneIds.push(q.id);
            } else {
                btns[idx].classList.add('border-red-500', 'bg-red-50');
                status.innerHTML = `<span class="text-red-400"><i class="fas fa-times-circle"></i> ä¸å¤ªå°å–”...</span>`;
                const correctIdx = q.randomOptions.findIndex(o => o.isCorrect);
                btns[correctIdx].classList.add('border-green-500', 'bg-green-50', 'ring-2', 'ring-green-200');
                state.wrongStats[q.id] = (state.wrongStats[q.id] || 0) + 1;
            }

            ratText.innerText = q.rationale;
            feedback.classList.remove('hidden');
            nextBtn.classList.remove('hidden');
            save();
        }

        // --- è™•ç†æ‰‹å¯«é¡Œ ---
        function revealHandwritingAnswer() {
            const q = state.currentBatch[state.batchIndex];
            const userInput = document.getElementById('handwritten-input').value.trim();
            
            if (!userInput) { if(!confirm("ä½ é‚„æ²’è¼¸å…¥ç­”æ¡ˆï¼Œè¦ç›´æ¥çœ‹æ­£è§£å—ï¼Ÿ")) return; }

            document.getElementById('handwritten-input').disabled = true;
            document.getElementById('show-ans-btn').classList.add('hidden');

            const feedback = document.getElementById('feedback');
            const status = document.getElementById('result-status');
            const ansArea = document.getElementById('correct-ans-area');
            const ratText = document.getElementById('rationale-text');
            const selfGradeBtns = document.getElementById('self-grade-btns');

            // ç°¡æ˜“é—œéµå­—æª¢æŸ¥ (è¼”åŠ©åˆ¤æ–·)
            const foundKeywords = q.keywords.filter(k => userInput.includes(k));
            const matchRate = foundKeywords.length / q.keywords.length;

            status.innerHTML = `<span class="text-cyan-400"><i class="fas fa-search"></i> é—œéµå­—æª¢æŸ¥ä¸­...</span>`;
            if (matchRate === 1) {
                status.innerHTML += `<div class="text-[10px] text-green-400 mt-1">åµæ¸¬åˆ°æ‰€æœ‰é—œéµå­—ï¼</div>`;
            } else if (matchRate > 0) {
                status.innerHTML += `<div class="text-[10px] text-yellow-400 mt-1">åµæ¸¬åˆ°éƒ¨åˆ†é—œéµå­—ï¼š${foundKeywords.join(', ')}</div>`;
            }

            ansArea.classList.remove('hidden');
            ratText.innerText = q.rationale;
            feedback.classList.remove('hidden');
            selfGradeBtns.classList.remove('hidden');
            feedback.scrollIntoView({ behavior: 'smooth' });
        }

        function recordHandwriting(isCorrect) {
            const q = state.currentBatch[state.batchIndex];
            if (isCorrect) {
                state.score++;
                if (state.wrongStats[q.id] > 0) state.wrongStats[q.id]--;
                if (!state.doneIds.includes(q.id)) state.doneIds.push(q.id);
            } else {
                state.wrongStats[q.id] = (state.wrongStats[q.id] || 0) + 1;
            }
            save();
            nextQuestion();
        }

        function nextQuestion() {
            state.batchIndex++;
            if (state.batchIndex < state.currentBatch.length) {
                renderQuiz();
            } else {
                renderHome();
            }
            save();
        }

        // --- æ’è¡Œæ¦œ ---
        function showLeaderboard() {
            const sorted = Object.entries(state.wrongStats)
                .filter(([id, count]) => count > 0)
                .map(([id, count]) => ({ ...questionBank.find(x => x.id === id), count }))
                .sort((a, b) => b.count - a.count);

            const listHtml = sorted.length === 0 
                ? `<div class="text-center py-20 text-slate-400 flex flex-col items-center gap-4">
                    <i class="fas fa-check-double text-5xl text-green-200"></i>
                    <p class="font-bold">ç›®å‰æˆ°ç¸¾è¼ç…Œï¼Œæ²’æœ‰ä»»ä½•éŒ¯é¡Œï¼</p>
                   </div>`
                : sorted.map((q, i) => `
                    <div class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex gap-4 items-center group active:bg-slate-50 transition">
                        <div class="w-10 h-10 rounded-xl ${i<3?'bg-red-500 text-white shadow-lg shadow-red-200':'bg-slate-100 text-slate-400'} flex items-center justify-center font-black italic">
                            ${i+1}
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-tighter">${q.chapter}</span>
                                <span class="text-xs font-black text-red-500 bg-red-50 px-2 py-0.5 rounded-full">éŒ¯ ${q.count} æ¬¡</span>
                            </div>
                            <p class="text-sm font-bold text-slate-700 line-clamp-1">${q.q}</p>
                        </div>
                        <button onclick="drillOne('${q.id}')" class="w-10 h-10 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center hover:bg-indigo-600 hover:text-white transition">
                            <i class="fas fa-bullseye"></i>
                        </button>
                    </div>
                `).join('');

            view.innerHTML = `
                <div class="p-4 fade-in min-h-full">
                    <div class="flex justify-between items-center mb-6 px-2">
                        <h2 class="text-2xl font-black text-slate-800">â˜ ï¸ éŒ¯é¡Œæ’è¡Œæ¦œ</h2>
                        <button onclick="renderHome()" class="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center text-slate-600"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="space-y-3 pb-24">
                        ${listHtml}
                    </div>
                </div>
            `;
        }

        function renderAllDone() {
            view.innerHTML = `
                <div class="p-10 text-center flex flex-col items-center justify-center min-h-full space-y-6 fade-in">
                    <div class="text-8xl">ğŸ†</div>
                    <h2 class="text-3xl font-black">å‚³èªªç´šæˆå°±ï¼šå…¨æ¸…ç©ºï¼</h2>
                    <p class="text-slate-500">æ‰€æœ‰çš„é¡Œç›®ä½ éƒ½è‡³å°‘åšå°éä¸€æ¬¡äº†ã€‚é€™ä»£è¡¨ä½ çš„åŸºç¤å·²ç¶“éå¸¸ç©©å›ºã€‚</p>
                    <button onclick="confirmReset()" class="bg-slate-900 text-white px-10 py-4 rounded-2xl font-bold shadow-2xl">é‡ç½®æ‰€æœ‰é€²åº¦ï¼Œå†ä¾†ä¸€è¼ª</button>
                    <button onclick="renderHome()" class="text-indigo-600 font-bold underline">å›ä¸»é é¢</button>
                </div>
            `;
        }

        function confirmReset() {
            if (confirm("ç¢ºå®šè¦é‡ç½®æ‰€æœ‰é€²åº¦å—ï¼Ÿé€™æœƒæ¸…é™¤æ’è¡Œæ¦œå’Œæ‰€æœ‰çš„å­¸ç¿’è¨˜éŒ„å–”ï¼")) {
                localStorage.removeItem(DB_KEY);
                location.reload();
            }
        }

        // åˆå§‹åŒ– App
        init();
    </script>
</body>
</html>
